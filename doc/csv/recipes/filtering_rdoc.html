<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>filtering - RDoc Documentation</title>

  <meta name="keywords" content="ruby,documentation,filtering">
  <meta name="description" content="filtering: Recipes for Filtering \CSV These recipes are specific code examples for specific \CSV filtering tasks. For other recipes, see {Recipes for CSV}[.">

<script type="text/javascript">
  var rdoc_rel_prefix = "../../../";
  var index_rel_prefix = "../../../";
</script>

<script src="../../../js/navigation.js" defer></script>
<script src="../../../js/search.js" defer></script>
<script src="../../../js/search_index.js" defer></script>
<script src="../../../js/searcher.js" defer></script>
<script src="../../../js/darkfish.js" defer></script>

<link href="../../../css/fonts.css" rel="stylesheet">
<link href="../../../css/rdoc.css" rel="stylesheet">


<body id="top" role="document" class="file">
<div id="navigation-toggle" role="button" tabindex="0" aria-label="Toggle sidebar" aria-expanded="true" aria-controls="navigation">
  <span aria-hidden="true">&#9776;</span>
</div>


<nav id="navigation" role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../../table_of_contents.html#pages">Pages</a>
    <a href="../../../table_of_contents.html#classes">Classes</a>
    <a href="../../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search (/) for a class, method, ..." spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>



  <ul class="link-list" role="directory">
              <li>
            <details open>
              <summary>      <a href="#label-Recipes+for+Filtering+CSV">Recipes for Filtering CSV</a>
</summary>
              <ul class="link-list" role="directory">
                          <li>      <a href="#label-Contents">Contents</a>
          <li>
            <details open>
              <summary>      <a href="#label-Source+and+Output+Formats">Source and Output Formats</a>
</summary>
              <ul class="link-list" role="directory">
                          <li>
            <details open>
              <summary>      <a href="#label-Filtering+String+to+String">Filtering String to String</a>
</summary>
              <ul class="link-list" role="directory">
                          <li>      <a href="#label-Recipe-3A+Filter+String+to+String+parsing+Headers">Recipe: Filter String to String parsing Headers</a>
          <li>      <a href="#label-Recipe-3A+Filter+String+to+String+parsing+and+writing+Headers">Recipe: Filter String to String parsing and writing Headers</a>
          <li>      <a href="#label-Recipe-3A+Filter+String+to+String+Without+Headers">Recipe: Filter String to String Without Headers</a>

              </ul>
            </details>
          </li>
          <li>
            <details open>
              <summary>      <a href="#label-Filtering+String+to+IO+Stream">Filtering String to IO Stream</a>
</summary>
              <ul class="link-list" role="directory">
                          <li>      <a href="#label-Recipe-3A+Filter+String+to+IO+Stream+parsing+Headers">Recipe: Filter String to IO Stream parsing Headers</a>
          <li>      <a href="#label-Recipe-3A+Filter+String+to+IO+Stream+parsing+and+writing+Headers">Recipe: Filter String to IO Stream parsing and writing Headers</a>
          <li>      <a href="#label-Recipe-3A+Filter+String+to+IO+Stream+Without+Headers">Recipe: Filter String to IO Stream Without Headers</a>

              </ul>
            </details>
          </li>
          <li>
            <details open>
              <summary>      <a href="#label-Filtering+IO+Stream+to+String">Filtering IO Stream to String</a>
</summary>
              <ul class="link-list" role="directory">
                          <li>      <a href="#label-Recipe-3A+Filter+IO+Stream+to+String+parsing+Headers">Recipe: Filter IO Stream to String parsing Headers</a>
          <li>      <a href="#label-Recipe-3A+Filter+IO+Stream+to+String+parsing+and+writing+Headers">Recipe: Filter IO Stream to String parsing and writing Headers</a>
          <li>      <a href="#label-Recipe-3A+Filter+IO+Stream+to+String+Without+Headers">Recipe: Filter IO Stream to String Without Headers</a>

              </ul>
            </details>
          </li>
          <li>
            <details open>
              <summary>      <a href="#label-Filtering+IO+Stream+to+IO+Stream">Filtering IO Stream to IO Stream</a>
</summary>
              <ul class="link-list" role="directory">
                          <li>      <a href="#label-Recipe-3A+Filter+IO+Stream+to+IO+Stream+parsing+Headers">Recipe: Filter IO Stream to IO Stream parsing Headers</a>
          <li>      <a href="#label-Recipe-3A+Filter+IO+Stream+to+IO+Stream+parsing+and+writing+Headers">Recipe: Filter IO Stream to IO Stream parsing and writing Headers</a>
          <li>      <a href="#label-Recipe-3A+Filter+IO+Stream+to+IO+Stream+Without+Headers">Recipe: Filter IO Stream to IO Stream Without Headers</a>

              </ul>
            </details>
          </li>

              </ul>
            </details>
          </li>

              </ul>
            </details>
          </li>

  </ul>
</div>

  
<div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
    <li><a href="../../../LICENSE_txt.html">LICENSE</a>
    <li><a href="../../../NEWS_md.html">NEWS</a>
    <li><a href="../../../README_md.html">README</a>
    <li><details open><summary>doc</summary>
    <ul class="link-list">
      <li><a href="../../../doc/csv/recipes/filtering_rdoc.html">filtering</a>
      <li><a href="../../../doc/csv/recipes/generating_rdoc.html">generating</a>
      <li><a href="../../../doc/csv/recipes/parsing_rdoc.html">parsing</a>
      <li><a href="../../../doc/csv/recipes/recipes_rdoc.html">recipes</a>
    </ul></details>
  </ul>
</div>


  <footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.13.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

</nav>

<main role="main" aria-label="Page doc/csv/recipes/filtering.rdoc">

<h2 id="label-Recipes+for+Filtering+CSV">Recipes for Filtering CSV<span><a href="#label-Recipes+for+Filtering+CSV">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>These recipes are specific code examples for specific CSV filtering tasks.</p>

<p>For other recipes, see <a href="./recipes_rdoc.html">Recipes for CSV</a>.</p>

<p>All code snippets on this page assume that the following has been executed:</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;csv&#39;</span>
</pre>

<h3 id="label-Contents">Contents<span><a href="#label-Contents">&para;</a> <a href="#top">&uarr;</a></span></h3>
<ul><li>
<p><a href="#label-Source+and+Output+Formats">Source and Output Formats</a></p>
<ul><li>
<p><a href="#label-Filtering+String+to+String">Filtering String to String</a></p>
<ul><li>
<p><a href="#label-Recipe-3A+Filter+String+to+String+parsing+Headers">Recipe: Filter String to String parsing Headers</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Filter+String+to+String+parsing+and+writing+Headers">Recipe: Filter String to String parsing and writing Headers</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Filter+String+to+String+Without+Headers">Recipe: Filter String to String Without Headers</a></p>
</li></ul>
</li><li>
<p><a href="#label-Filtering+String+to+IO+Stream">Filtering String to IO Stream</a></p>
<ul><li>
<p><a href="#label-Recipe-3A+Filter+String+to+IO+Stream+parsing+Headers">Recipe: Filter String to IO Stream parsing Headers</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Filter+String+to+IO+Stream+parsing+and+writing+Headers">Recipe: Filter String to IO Stream parsing and writing Headers</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Filter+String+to+IO+Stream+Without+Headers">Recipe: Filter String to IO Stream Without Headers</a></p>
</li></ul>
</li><li>
<p><a href="#label-Filtering+IO+Stream+to+String">Filtering IO Stream to String</a></p>
<ul><li>
<p><a href="#label-Recipe-3A+Filter+IO+Stream+to+String+parsing+Headers">Recipe: Filter IO Stream to String parsing Headers</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Filter+IO+Stream+to+String+parsing+and+writing+Headers">Recipe: Filter IO Stream to String parsing and writing Headers</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Filter+IO+Stream+to+String+Without+Headers">Recipe: Filter IO Stream to String Without Headers</a></p>
</li></ul>
</li><li>
<p><a href="#label-Filtering+IO+Stream+to+IO+Stream">Filtering IO Stream to IO Stream</a></p>
<ul><li>
<p><a href="#label-Recipe-3A+Filter+IO+Stream+to+IO+Stream+parsing+Headers">Recipe: Filter IO Stream to IO Stream parsing Headers</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Filter+IO+Stream+to+IO+Stream+parsing+and+writing+Headers">Recipe: Filter IO Stream to IO Stream parsing and writing Headers</a></p>
</li><li>
<p><a href="#label-Recipe-3A+Filter+IO+Stream+to+IO+Stream+Without+Headers">Recipe: Filter IO Stream to IO Stream Without Headers</a></p>
</li></ul>
</li></ul>
</li></ul>

<h3 id="label-Source+and+Output+Formats">Source and Output Formats<span><a href="#label-Source+and+Output+Formats">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>You can use a Unix-style “filter” for CSV data. The filter reads source CSV data and writes output CSV data as modified by the filter. The input and output CSV data may be any mixture of Strings and IO streams.</p>

<h4 id="label-Filtering+String+to+String">Filtering String to String<span><a href="#label-Filtering+String+to+String">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>You can filter one String to another, with or without headers.</p>

<h5 id="label-Recipe-3A+Filter+String+to+String+parsing+Headers">Recipe: Filter String to String parsing Headers<span><a href="#label-Recipe-3A+Filter+String+to+String+parsing+Headers">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>Use class method <a href="../../../CSV.html#method-c-filter"><code>CSV.filter</code></a> with option <code>headers</code> to filter a String to another String:</p>

<pre class="ruby"><span class="ruby-identifier">in_string</span> = <span class="ruby-string">&quot;Name,Value\nfoo,0\nbar,1\nbaz,2\n&quot;</span>
<span class="ruby-identifier">out_string</span> = <span class="ruby-string">&#39;&#39;</span>
<span class="ruby-constant">CSV</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">in_string</span>, <span class="ruby-identifier">out_string</span>, <span class="ruby-value">headers:</span> <span class="ruby-keyword">true</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Name&#39;</span>] = <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Name&#39;</span>].<span class="ruby-identifier">upcase</span>
  <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Value&#39;</span>] <span class="ruby-operator">*=</span> <span class="ruby-value">4</span>
<span class="ruby-keyword">end</span>
<span class="ruby-identifier">out_string</span> <span class="ruby-comment"># =&gt; &quot;FOO,0000\nBAR,1111\nBAZ,2222\n&quot;</span>
</pre>

<h5 id="label-Recipe-3A+Filter+String+to+String+parsing+and+writing+Headers">Recipe: Filter String to String parsing and writing Headers<span><a href="#label-Recipe-3A+Filter+String+to+String+parsing+and+writing+Headers">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>Use class method <a href="../../../CSV.html#method-c-filter"><code>CSV.filter</code></a> with option <code>headers</code> and <code>out_write_headers</code> to filter a String to another String including header row:</p>

<pre class="ruby"><span class="ruby-identifier">in_string</span> = <span class="ruby-string">&quot;Name,Value\nfoo,0\nbar,1\nbaz,2\n&quot;</span>
<span class="ruby-identifier">out_string</span> = <span class="ruby-string">&#39;&#39;</span>
<span class="ruby-constant">CSV</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">in_string</span>, <span class="ruby-identifier">out_string</span>, <span class="ruby-value">headers:</span> <span class="ruby-keyword">true</span>, <span class="ruby-value">out_write_headers:</span> <span class="ruby-keyword">true</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">row</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
    <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Name&#39;</span>] = <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Name&#39;</span>].<span class="ruby-identifier">upcase</span>
    <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Value&#39;</span>] <span class="ruby-operator">*=</span> <span class="ruby-value">4</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
<span class="ruby-identifier">out_string</span> <span class="ruby-comment"># =&gt; &quot;Name,Value\nFOO,0000\nBAR,1111\nBAZ,2222\n&quot;</span>
</pre>

<h5 id="label-Recipe-3A+Filter+String+to+String+Without+Headers">Recipe: Filter String to String Without Headers<span><a href="#label-Recipe-3A+Filter+String+to+String+Without+Headers">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>Use class method <a href="../../../CSV.html#method-c-filter"><code>CSV.filter</code></a> without option <code>headers</code> to filter a String to another String:</p>

<pre class="ruby"><span class="ruby-identifier">in_string</span> = <span class="ruby-string">&quot;foo,0\nbar,1\nbaz,2\n&quot;</span>
<span class="ruby-identifier">out_string</span> = <span class="ruby-string">&#39;&#39;</span>
<span class="ruby-constant">CSV</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">in_string</span>, <span class="ruby-identifier">out_string</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">row</span>[<span class="ruby-value">0</span>] = <span class="ruby-identifier">row</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">upcase</span>
  <span class="ruby-identifier">row</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">*=</span> <span class="ruby-value">4</span>
<span class="ruby-keyword">end</span>
<span class="ruby-identifier">out_string</span> <span class="ruby-comment"># =&gt; &quot;FOO,0000\nBAR,1111\nBAZ,2222\n&quot;</span>
</pre>

<h4 id="label-Filtering+String+to+IO+Stream">Filtering String to IO Stream<span><a href="#label-Filtering+String+to+IO+Stream">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>You can filter a String to an IO stream, with or without headers.</p>

<h5 id="label-Recipe-3A+Filter+String+to+IO+Stream+parsing+Headers">Recipe: Filter String to IO Stream parsing Headers<span><a href="#label-Recipe-3A+Filter+String+to+IO+Stream+parsing+Headers">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>Use class method <a href="../../../CSV.html#method-c-filter"><code>CSV.filter</code></a> with option <code>headers</code> to filter a String to an IO stream:</p>

<pre class="ruby"><span class="ruby-identifier">in_string</span> = <span class="ruby-string">&quot;Name,Value\nfoo,0\nbar,1\nbaz,2\n&quot;</span>
<span class="ruby-identifier">path</span> = <span class="ruby-string">&#39;t.csv&#39;</span>
<span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span>, <span class="ruby-string">&#39;w&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">out_io</span><span class="ruby-operator">|</span>
  <span class="ruby-constant">CSV</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">in_string</span>, <span class="ruby-identifier">out_io</span>, <span class="ruby-value">headers:</span> <span class="ruby-keyword">true</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Name&#39;</span>] = <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Name&#39;</span>].<span class="ruby-identifier">upcase</span>
    <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Value&#39;</span>] <span class="ruby-operator">*=</span> <span class="ruby-value">4</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
<span class="ruby-identifier">p</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">path</span>) <span class="ruby-comment"># =&gt; &quot;FOO,0000\nBAR,1111\nBAZ,2222\n&quot;</span>
</pre>

<h5 id="label-Recipe-3A+Filter+String+to+IO+Stream+parsing+and+writing+Headers">Recipe: Filter String to IO Stream parsing and writing Headers<span><a href="#label-Recipe-3A+Filter+String+to+IO+Stream+parsing+and+writing+Headers">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>Use class method <a href="../../../CSV.html#method-c-filter"><code>CSV.filter</code></a> with option <code>headers</code> and <code>out_write_headers</code> to filter a String to an IO stream including header row:</p>

<pre class="ruby"><span class="ruby-identifier">in_string</span> = <span class="ruby-string">&quot;Name,Value\nfoo,0\nbar,1\nbaz,2\n&quot;</span>
<span class="ruby-identifier">path</span> = <span class="ruby-string">&#39;t.csv&#39;</span>
<span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span>, <span class="ruby-string">&#39;w&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">out_io</span><span class="ruby-operator">|</span>
  <span class="ruby-constant">CSV</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">in_string</span>, <span class="ruby-identifier">out_io</span>, <span class="ruby-value">headers:</span> <span class="ruby-keyword">true</span>, <span class="ruby-value">out_write_headers:</span> <span class="ruby-keyword">true</span> ) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">row</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
      <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Name&#39;</span>] = <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Name&#39;</span>].<span class="ruby-identifier">upcase</span>
      <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Value&#39;</span>] <span class="ruby-operator">*=</span> <span class="ruby-value">4</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
<span class="ruby-identifier">p</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">path</span>) <span class="ruby-comment"># =&gt; &quot;Name,Value\nFOO,0000\nBAR,1111\nBAZ,2222\n&quot;</span>
</pre>

<h5 id="label-Recipe-3A+Filter+String+to+IO+Stream+Without+Headers">Recipe: Filter String to IO Stream Without Headers<span><a href="#label-Recipe-3A+Filter+String+to+IO+Stream+Without+Headers">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>Use class method <a href="../../../CSV.html#method-c-filter"><code>CSV.filter</code></a> without option <code>headers</code> to filter a String to an IO stream:</p>

<pre class="ruby"><span class="ruby-identifier">in_string</span> = <span class="ruby-string">&quot;foo,0\nbar,1\nbaz,2\n&quot;</span>
<span class="ruby-identifier">path</span> = <span class="ruby-string">&#39;t.csv&#39;</span>
<span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span>, <span class="ruby-string">&#39;w&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">out_io</span><span class="ruby-operator">|</span>
  <span class="ruby-constant">CSV</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">in_string</span>, <span class="ruby-identifier">out_io</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">row</span>[<span class="ruby-value">0</span>] = <span class="ruby-identifier">row</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">upcase</span>
    <span class="ruby-identifier">row</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">*=</span> <span class="ruby-value">4</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
<span class="ruby-identifier">p</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">path</span>) <span class="ruby-comment"># =&gt; &quot;FOO,0000\nBAR,1111\nBAZ,2222\n&quot;</span>
</pre>

<h4 id="label-Filtering+IO+Stream+to+String">Filtering IO Stream to String<span><a href="#label-Filtering+IO+Stream+to+String">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>You can filter an IO stream to a String, with or without headers.</p>

<h5 id="label-Recipe-3A+Filter+IO+Stream+to+String+parsing+Headers">Recipe: Filter IO Stream to String parsing Headers<span><a href="#label-Recipe-3A+Filter+IO+Stream+to+String+parsing+Headers">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>Use class method <a href="../../../CSV.html#method-c-filter"><code>CSV.filter</code></a> with option <code>headers</code> to filter an IO stream to a String:</p>

<pre class="ruby"><span class="ruby-identifier">in_string</span> = <span class="ruby-string">&quot;Name,Value\nfoo,0\nbar,1\nbaz,2\n&quot;</span>
<span class="ruby-identifier">path</span> = <span class="ruby-string">&#39;t.csv&#39;</span>
<span class="ruby-constant">File</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">in_string</span>)
<span class="ruby-identifier">out_string</span> = <span class="ruby-string">&#39;&#39;</span>
<span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">in_io</span><span class="ruby-operator">|</span>
  <span class="ruby-constant">CSV</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">in_io</span>, <span class="ruby-identifier">out_string</span>, <span class="ruby-value">headers:</span> <span class="ruby-keyword">true</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Name&#39;</span>] = <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Name&#39;</span>].<span class="ruby-identifier">upcase</span>
    <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Value&#39;</span>] <span class="ruby-operator">*=</span> <span class="ruby-value">4</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
<span class="ruby-identifier">out_string</span> <span class="ruby-comment"># =&gt; &quot;FOO,0000\nBAR,1111\nBAZ,2222\n&quot;</span>
</pre>

<h5 id="label-Recipe-3A+Filter+IO+Stream+to+String+parsing+and+writing+Headers">Recipe: Filter IO Stream to String parsing and writing Headers<span><a href="#label-Recipe-3A+Filter+IO+Stream+to+String+parsing+and+writing+Headers">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>Use class method <a href="../../../CSV.html#method-c-filter"><code>CSV.filter</code></a> with option <code>headers</code> and <code>out_write_headers</code> to filter an IO stream to a String including header row:</p>

<pre class="ruby"><span class="ruby-identifier">in_string</span> = <span class="ruby-string">&quot;Name,Value\nfoo,0\nbar,1\nbaz,2\n&quot;</span>
<span class="ruby-identifier">path</span> = <span class="ruby-string">&#39;t.csv&#39;</span>
<span class="ruby-constant">File</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">in_string</span>)
<span class="ruby-identifier">out_string</span> = <span class="ruby-string">&#39;&#39;</span>
<span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">in_io</span><span class="ruby-operator">|</span>
  <span class="ruby-constant">CSV</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">in_io</span>, <span class="ruby-identifier">out_string</span>, <span class="ruby-value">headers:</span> <span class="ruby-keyword">true</span>, <span class="ruby-value">out_write_headers:</span> <span class="ruby-keyword">true</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">row</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
      <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Name&#39;</span>] = <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Name&#39;</span>].<span class="ruby-identifier">upcase</span>
      <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Value&#39;</span>] <span class="ruby-operator">*=</span> <span class="ruby-value">4</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
<span class="ruby-identifier">out_string</span> <span class="ruby-comment"># =&gt; &quot;Name,Value\nFOO,0000\nBAR,1111\nBAZ,2222\n&quot;</span>
</pre>

<h5 id="label-Recipe-3A+Filter+IO+Stream+to+String+Without+Headers">Recipe: Filter IO Stream to String Without Headers<span><a href="#label-Recipe-3A+Filter+IO+Stream+to+String+Without+Headers">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>Use class method <a href="../../../CSV.html#method-c-filter"><code>CSV.filter</code></a> without option <code>headers</code> to filter an IO stream to a String:</p>

<pre class="ruby"><span class="ruby-identifier">in_string</span> = <span class="ruby-string">&quot;foo,0\nbar,1\nbaz,2\n&quot;</span>
<span class="ruby-identifier">path</span> = <span class="ruby-string">&#39;t.csv&#39;</span>
<span class="ruby-constant">File</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">in_string</span>)
<span class="ruby-identifier">out_string</span> = <span class="ruby-string">&#39;&#39;</span>
<span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">in_io</span><span class="ruby-operator">|</span>
  <span class="ruby-constant">CSV</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">in_io</span>, <span class="ruby-identifier">out_string</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">row</span>[<span class="ruby-value">0</span>] = <span class="ruby-identifier">row</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">upcase</span>
    <span class="ruby-identifier">row</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">*=</span> <span class="ruby-value">4</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
<span class="ruby-identifier">out_string</span> <span class="ruby-comment"># =&gt; &quot;FOO,0000\nBAR,1111\nBAZ,2222\n&quot;</span>
</pre>

<h4 id="label-Filtering+IO+Stream+to+IO+Stream">Filtering IO Stream to IO Stream<span><a href="#label-Filtering+IO+Stream+to+IO+Stream">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>You can filter an IO stream to another IO stream, with or without headers.</p>

<h5 id="label-Recipe-3A+Filter+IO+Stream+to+IO+Stream+parsing+Headers">Recipe: Filter IO Stream to IO Stream parsing Headers<span><a href="#label-Recipe-3A+Filter+IO+Stream+to+IO+Stream+parsing+Headers">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>Use class method <a href="../../../CSV.html#method-c-filter"><code>CSV.filter</code></a> with option <code>headers</code> to filter an IO stream to another IO stream:</p>

<pre class="ruby"><span class="ruby-identifier">in_path</span> = <span class="ruby-string">&#39;t.csv&#39;</span>
<span class="ruby-identifier">in_string</span> = <span class="ruby-string">&quot;Name,Value\nfoo,0\nbar,1\nbaz,2\n&quot;</span>
<span class="ruby-constant">File</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">in_path</span>, <span class="ruby-identifier">in_string</span>)
<span class="ruby-identifier">out_path</span> = <span class="ruby-string">&#39;u.csv&#39;</span>
<span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">in_path</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">in_io</span><span class="ruby-operator">|</span>
  <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">out_path</span>, <span class="ruby-string">&#39;w&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">out_io</span><span class="ruby-operator">|</span>
    <span class="ruby-constant">CSV</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">in_io</span>, <span class="ruby-identifier">out_io</span>, <span class="ruby-value">headers:</span> <span class="ruby-keyword">true</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Name&#39;</span>] = <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Name&#39;</span>].<span class="ruby-identifier">upcase</span>
      <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Value&#39;</span>] <span class="ruby-operator">*=</span> <span class="ruby-value">4</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
<span class="ruby-identifier">p</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">out_path</span>) <span class="ruby-comment"># =&gt; &quot;FOO,0000\nBAR,1111\nBAZ,2222\n&quot;</span>
</pre>

<h5 id="label-Recipe-3A+Filter+IO+Stream+to+IO+Stream+parsing+and+writing+Headers">Recipe: Filter IO Stream to IO Stream parsing and writing Headers<span><a href="#label-Recipe-3A+Filter+IO+Stream+to+IO+Stream+parsing+and+writing+Headers">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>Use class method <a href="../../../CSV.html#method-c-filter"><code>CSV.filter</code></a> with option <code>headers</code> and <code>out_write_headers</code> to filter an IO stream to another IO stream including header row:</p>

<pre class="ruby"><span class="ruby-identifier">in_path</span> = <span class="ruby-string">&#39;t.csv&#39;</span>
<span class="ruby-identifier">in_string</span> = <span class="ruby-string">&quot;Name,Value\nfoo,0\nbar,1\nbaz,2\n&quot;</span>
<span class="ruby-constant">File</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">in_path</span>, <span class="ruby-identifier">in_string</span>)
<span class="ruby-identifier">out_path</span> = <span class="ruby-string">&#39;u.csv&#39;</span>
<span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">in_path</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">in_io</span><span class="ruby-operator">|</span>
  <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">out_path</span>, <span class="ruby-string">&#39;w&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">out_io</span><span class="ruby-operator">|</span>
    <span class="ruby-constant">CSV</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">in_io</span>, <span class="ruby-identifier">out_io</span>, <span class="ruby-value">headers:</span> <span class="ruby-keyword">true</span>, <span class="ruby-value">out_write_headers:</span> <span class="ruby-keyword">true</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">unless</span> <span class="ruby-identifier">row</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
        <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Name&#39;</span>] = <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Name&#39;</span>].<span class="ruby-identifier">upcase</span>
        <span class="ruby-identifier">row</span>[<span class="ruby-string">&#39;Value&#39;</span>] <span class="ruby-operator">*=</span> <span class="ruby-value">4</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
<span class="ruby-identifier">p</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">out_path</span>) <span class="ruby-comment"># =&gt; &quot;Name,Value\nFOO,0000\nBAR,1111\nBAZ,2222\n&quot;</span>
</pre>

<h5 id="label-Recipe-3A+Filter+IO+Stream+to+IO+Stream+Without+Headers">Recipe: Filter IO Stream to IO Stream Without Headers<span><a href="#label-Recipe-3A+Filter+IO+Stream+to+IO+Stream+Without+Headers">&para;</a> <a href="#top">&uarr;</a></span></h5>

<p>Use class method <a href="../../../CSV.html#method-c-filter"><code>CSV.filter</code></a> without option <code>headers</code> to filter an IO stream to another IO stream:</p>

<pre class="ruby"><span class="ruby-identifier">in_path</span> = <span class="ruby-string">&#39;t.csv&#39;</span>
<span class="ruby-identifier">in_string</span> = <span class="ruby-string">&quot;foo,0\nbar,1\nbaz,2\n&quot;</span>
<span class="ruby-constant">File</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">in_path</span>, <span class="ruby-identifier">in_string</span>)
<span class="ruby-identifier">out_path</span> = <span class="ruby-string">&#39;u.csv&#39;</span>
<span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">in_path</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">in_io</span><span class="ruby-operator">|</span>
  <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">out_path</span>, <span class="ruby-string">&#39;w&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">out_io</span><span class="ruby-operator">|</span>
    <span class="ruby-constant">CSV</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">in_io</span>, <span class="ruby-identifier">out_io</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">row</span>[<span class="ruby-value">0</span>] = <span class="ruby-identifier">row</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">upcase</span>
      <span class="ruby-identifier">row</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">*=</span> <span class="ruby-value">4</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
<span class="ruby-identifier">p</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">out_path</span>) <span class="ruby-comment"># =&gt; &quot;FOO,0000\nBAR,1111\nBAZ,2222\n&quot;</span>
</pre>

</main>

